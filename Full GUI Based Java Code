import javafx.application.Application;
import javafx.stage.Stage;
import javafx.scene.Scene;
import javafx.scene.layout.*;
import javafx.scene.control.*;
import javafx.geometry.*;
import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.beans.property.SimpleDoubleProperty;
import javafx.beans.property.SimpleStringProperty;

public class FraudDetectionApp extends Application {
    private double threshold = 1000.0;
    private ObservableList<Transaction> transactions = FXCollections.observableArrayList();

    public static void main(String[] args) {
        launch(args); 
    }

    @Override
    public void start(Stage primaryStage) {
        // Sample transactions
        transactions.addAll(
            new Transaction("TXN001", 500.0),
            new Transaction("TXN002", 1500.0),
            new Transaction("TXN003", 2000.0),
            new Transaction("TXN004", 750.0)
        );
        // Main menu layout
        Button adminButton = new Button("Admin Dashboard");
        Button userButton  = new Button("User Dashboard");
        adminButton.setOnAction(e -> showAdminDashboard(primaryStage));
        userButton.setOnAction(e -> showUserDashboard(primaryStage));
        VBox mainMenu = new VBox(10, new Label("Main Menu"), adminButton, userButton);
        mainMenu.setAlignment(Pos.CENTER);
        mainMenu.setPadding(new Insets(20));
        primaryStage.setScene(new Scene(mainMenu, 300, 200));
        primaryStage.setTitle("Fraud Detection System");
        primaryStage.show();
    }

    private void showAdminDashboard(Stage stage) {
        // Threshold controls
        Label label = new Label("Set Fraud Threshold:");
        TextField threshField = new TextField(Double.toString(threshold));
        Button setBtn = new Button("Set Threshold");
        setBtn.setOnAction(e -> {
            try {
                threshold = Double.parseDouble(threshField.getText());
            } catch (NumberFormatException ex) {
                // ignore invalid input
            }
        });
        HBox threshBox = new HBox(10, label, threshField, setBtn);
        threshBox.setAlignment(Pos.CENTER);

        // Table of all transactions
        TableView<Transaction> table = new TableView<>();
        TableColumn<Transaction,String> idCol = new TableColumn<>("Transaction ID");
        idCol.setCellValueFactory(data -> data.getValue().idProperty());
        TableColumn<Transaction,Number> amtCol = new TableColumn<>("Amount");
        amtCol.setCellValueFactory(data -> data.getValue().amountProperty());
        table.getColumns().addAll(idCol, amtCol);
        table.setItems(transactions);

        VBox adminLayout = new VBox(10, threshBox, table);
        adminLayout.setPadding(new Insets(10));
        stage.setScene(new Scene(adminLayout, 400, 300));
        stage.setTitle("Admin Dashboard");
    }

    private void showUserDashboard(Stage stage) {
        // Filter transactions above threshold
        ObservableList<Transaction> suspicious = FXCollections.observableArrayList();
        for (Transaction t : transactions) {
            if (t.getAmount() > threshold) {
                suspicious.add(t);
            }
        }
        Label infoLabel = new Label("Suspicious Transactions (>" + threshold + "):");
        TableView<Transaction> table = new TableView<>();
        TableColumn<Transaction,String> idCol = new TableColumn<>("Transaction ID");
        idCol.setCellValueFactory(data -> data.getValue().idProperty());
        TableColumn<Transaction,Number> amtCol = new TableColumn<>("Amount");
        amtCol.setCellValueFactory(data -> data.getValue().amountProperty());
        table.getColumns().addAll(idCol, amtCol);
        table.setItems(suspicious);

        VBox userLayout = new VBox(10, infoLabel, table);
        userLayout.setPadding(new Insets(10));
        stage.setScene(new Scene(userLayout, 300, 200));
        stage.setTitle("User Dashboard");
    }

    // Transaction data model
    public static class Transaction {
        private final SimpleStringProperty id;
        private final SimpleDoubleProperty amount;
        public Transaction(String id, double amount) {
            this.id = new SimpleStringProperty(id);
            this.amount = new SimpleDoubleProperty(amount);
        }
        public String getId() { return id.get(); }
        public double getAmount() { return amount.get(); }
        public SimpleStringProperty idProperty() { return id; }
        public SimpleDoubleProperty amountProperty() { return amount; }
    }
}
